<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">

<!--
`responsive-breakpoints`
A LRN element

@demo demo/index.html

@microcopy - the mental model for this element


-->

<dom-module id="responsive-breakpoints">
  <template>
    <style>
      :host {
        display: block;
        width: 100%;
        margin-right: auto;
        margin-left: auto;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
      }
      :host:before,
      :host:after {
        content: " ";
        display: table;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
      }
      :host:after {
        clear: both;
      }
    </style>
    <juicy-html model="{{model}}" html="{{model.html}}"></juicy-html>
    <slot></slot>
  </template>

  <script>
    Polymer({

      is: 'responsive-breakpoints',

      behaviors: [
        Polymer.IronResizableBehavior
      ],

      listeners: {
        'iron-resize': '_onIronResize'
      },

      properties: {
        /**
         * Set small breakpoint
         */
        sm: {
          type: Number,
          value: 600,
        },
        /**
         * Set medium breakpoint
         */
        md: {
          type: Number,
          value: 900,
        },
        /**
         * Set small breakpoint
         */
        lg: {
          type: Number,
          value: 1200,
        },
        /**
         * Set medium breakpoint
         */
        xl: {
          type: Number,
          value: 1800,
        },
      },
      attached: function() {
        this.async(this.notifyResize, 1);
      },
      get parent() {
        console.log(this,this.parentNode);
        if (this.parentNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {
          console.log(this.parentNode.host);
          return this.parentNode.host;
        }
        console.log(this.parentNode);
        return this.parentNode;
      },
      /**
       * On resize test for determine breakpoints
       */
      _onIronResize: function() {
        console.log(window.outerWidth);
        let screen = 'xl';
        this.__currentSize = this.__currentSize !== undefined ? this.__currentSize : 'extra-small-screen';
        if(window.outerWidth < this.sm) {
          screen = 'xs';
        } else if(window.outerWidth < this.md) {
          screen = 'sm';
          console.log('small');
        } else if(window.outerWidth < this.lg) {
          screen = 'md';
        } else if(window.outerWidth < this.xl) {
          screen = 'lg';
        }
        if (screen !== this.__currentSize) {
          this.__currentSize = screen;
          this.fire('screen-resize',{screen: this.__currentSize} );
        }
      },
    });
  </script>
</dom-module>
